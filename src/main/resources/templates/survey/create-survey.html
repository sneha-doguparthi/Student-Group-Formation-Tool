<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Survey</title>
    <script>
        function onChangeCriteria(questionId) {
            var selectDrpDwn = document.getElementById("criteria_"+questionId);
            var option = selectDrpDwn.options[selectDrpDwn.selectedIndex].value;
            document.getElementById("selectedQuestionId_"+questionId).value = questionId + " - " + option;
        }
    </script>
</head>
<body>
<ul lang="en" th:replace="fragments/course-header :: course-header"></ul>
<div class="container">
<form th:action="@{/survey/addQuestions}" method="POST">
    <p>
        Add Questions from question bank
    </p>
    <select class="selectQuestions" id="questionSelected" name="questionSelected">
        <option value="">------------------------------ Select ---------------------------</option>
        <option th:each="ques : ${questions}" th:value="${ques.questionId}" th:text="${ques.questionText}"></option>
    </select>
    <button id="submit" class="btn btn-primary">Add Question to Survey</button>
</form >
    <br>
    <form th:action="@{/survey/publish}" method="POST">
        <button id="publish" class="btn btn-primary float-right" onclick="return confirm('Are you sure to publish the survey?')">Publish Survey</button>
        </p>
    </form>
    <form th:object="${surveyModel}" th:action="@{/survey/save-survey}" method="POST" >
        <p>Group Size</p>
        <select style="width: 200px;" class="custom-select"
                id="group-size"
                name="group" th:field="*{groupSize}">
            <option value="2" selected="selected">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
        <button id="save" type="submit" class="btn btn-primary float-right">Save Survey</button>
        <br>
        <table class="table table-bordered table-striped" id="questions">
            <thead class="thead-dark">
            <tr>
                <th class="center-text">Question Type</th>
                <th class="center-text">Question Title</th>
                <th class="center-text">Question Text</th>
                <th class="center-text">Logic Detail</th>
                <th class="center-text">Numeric Value</th>
                <th class="center-text">Action</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="question,i : ${surveyModel.questionList}">
                <input type="hidden" th:name="selectedQuestionInfo" th:id="'selectedQuestionId_'+${question.questionId}" />
<!--                <input type="hidden" name="questionId" th:value="${question.questionId}"  th:field="*{questionList[__${i.index}__].questionId}"  />-->
                <td><span  th:text="${question.questionType}"> Type </span></td>
                <td><span th:text="${question.questionTitle}"> Title </span></td>
                <td><span th:text="${question.questionText}"> Text </span></td>
                <td><span>
<!--              <select class="select"-->
<!--                      id="criteria" required th:field="*{questionList[__${i.index}__].criteria}">-->
                    <select class="select" th:id="'criteria_'+${question.questionId}" required th:onChange="|onChangeCriteria('${question.questionId}')|">
							<option value="">------ Select ------</option>
							<option value="similar" >Group Similar</option>
							<option value="dissimilar">Group Dissimilar</option>
                            <option th:if="${question.questionType} == 'NUM'"
                                    value="greater than"> Greater than(>) </option>
                            <option th:if="${question.questionType} == 'NUM'"
                                    value="lesser than">Lesser than(<) </option>
              </select>
            </span></td>
                <td><span><input type="text" th:if="${question.questionType} == 'NUM'"></span></td>
                <td class="center-text">
                        <input type="hidden" name="deleteQuestionId" id="questionId" th:value="${question.questionId}" />
                        <a th:href="@{'/survey/delete-question/'+${question.questionId}}" onclick="return confirm('Confirm delete?')" class="btn btn-primary"
                                style="background-color: #ff2222;">Delete</a>

                </td>
            </tr>
            </tbody>
        </table>
    </form>

</div>
</body>
</html>